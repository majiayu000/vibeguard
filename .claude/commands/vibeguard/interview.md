---
name: "VibeGuard: Interview"
description: "大功能开始前深度采访用户需求，挖掘边界情况和技术权衡，输出结构化 SPEC"
category: VibeGuard
tags: [vibeguard, interview, requirements, spec]
---

<!-- VIBEGUARD:INTERVIEW:START -->
**核心理念**（来自 Anthropic 官方最佳实践）
- 大功能的失败往往源于需求不清晰，而非实现不正确
- AI 主动采访用户，挖掘未考虑到的边界情况和技术权衡
- 采访结束后输出结构化 SPEC，建议在**新会话**中执行以获得干净上下文

**触发条件**
- 涉及新功能/新模块的开发
- 需求描述模糊或不完整
- 影响多个模块的变更（复杂度路由 6+ 文件级别）

**Guardrails**
- 不做任何代码修改，只分析和采访
- 最多 4 轮采访，每轮 2-4 个问题，保持节奏紧凑
- 不问显而易见的问题，**专挖用户没想到的难点**
- 用户说"你决定"的问题，给出推荐方案并记录

**Steps**

1. **理解初始需求**
   - 读取用户需求描述（$ARGUMENTS 或当前上下文）
   - 快速扫描相关代码，理解现有架构和约束
   - 识别需求中的模糊点和未定义的边界

2. **深度采访**（使用 AskUserQuestion 工具）

   **第 1 轮：功能边界**
   - 核心用例是什么？哪些场景明确不做？
   - 有没有类似功能可以参考的现有实现？

   **第 2 轮：技术实现**
   - 性能/延迟要求？数据存储偏好？
   - 需要兼容哪些现有接口？

   **第 3 轮：边界情况**
   - 并发/竞态怎么处理？错误时的预期行为？
   - 数据量大时的降级策略？

   **第 4 轮：验收标准**
   - 怎么算"做完了"？需要哪些测试覆盖？
   - 有没有必须通过的性能基准？

   根据前一轮回答动态调整问题方向。如果前几轮已经覆盖充分，可以提前结束采访。

3. **生成 SPEC**

   ```markdown
   # Feature Spec: <功能名>
   ## 概述
   一句话描述 + 核心价值

   ## 功能需求
   - FR-01: ...

   ## 非功能需求
   - NFR-01: 性能/安全/兼容性要求

   ## 技术设计
   ### 影响范围
   - 新增: ...
   - 修改: ...
   ### 接口定义
   ### 数据模型变更

   ## 边界情况
   - EC-01: ...

   ## 验收标准
   - [ ] AC-01: ...
   ```

4. **确认并保存**
   - 展示 SPEC 给用户确认
   - 保存到项目根目录 `SPEC.md`（或用户指定路径）
   - 提醒用户：**建议在新会话中执行 SPEC**，干净上下文实现更可靠

**后续衔接**
- 新会话中：读取 SPEC.md → `/vibeguard:preflight` 生成约束集 → 按 SPEC 实现
<!-- VIBEGUARD:INTERVIEW:END -->
